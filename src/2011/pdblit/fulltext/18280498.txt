doi:10.1016/j.jmb.2004.02.015

J. Mol. Biol. (2004) 337, 1161­1182

Testing a Flexible-receptor Docking Algorithm in a Model Binding Site
Binqing Q. Wei1, Larry H. Weaver2, Anna M. Ferrari1 Brian W. Matthews2* and Brian K. Shoichet1*
1 Department of Pharmaceutical Chemistry, University of California, 600 16th St., San Francisco, CA 94143-2240 USA

Institute of Molecular Biology Howard Hughes Medical Institute, University of Oregon Eugene, OR 97403, USA

2

Sampling receptor flexibility is challenging for database docking. We consider a method that treats multiple flexible regions of the binding site independently, recombining them to generate different discrete conformations. This algorithm scales linearly rather than exponentially with the receptor's degrees of freedom. The method was first evaluated for its ability to identify known ligands of a hydrophobic cavity mutant of T4 lysozyme (L99A). Some 200,000 molecules of the Available Chemical Directory (ACD) were docked against an ensemble of cavity conformations. Surprisingly, the enrichment of known ligands from among a much larger number of decoys in the ACD was worse than simply docking to the apo conformation alone. Large decoys, accommodated in the larger cavity conformations sampled in the ensemble, were ranked better than known small ligands. The calculation was redone with an energy correction term that considered the cost of forming the larger cavity conformations. Enrichment improved, as did the balance between high-ranking large and small ligands. In a second retrospective test, the ACD was docked against a conformational ensemble of thymidylate synthase. Compared to docking against individual enzyme conformations, the flexible receptor docking approach improved enrichment of known ligands. Including a receptor conformational energy weighting term improved enrichment further. To test the method prospectively, the ACD database was docked against another cavity mutant of lysozyme (L99A/M102Q). A total of 18 new compounds predicted to bind this polar cavity and to change its conformation were tested experimentally; 14 were found to bind. The bound structures for seven ligands were determined by X-ray crystallography. The predicted geometries of these ° ligands all corresponded to the observed geometries to within 0.7 A RMSD or better. Significant conformational changes of the cavity were observed in all seven complexes. In five structures, part of the observed accommodations were correctly predicted; in two structures, the receptor conformational changes were unanticipated and thus never sampled. These results suggest that although sampling receptor flexibility can lead to novel ligands that would have been missed when docking a rigid structure, it is also important to consider receptor conformational energy.
q 2004 Elsevier Ltd. All rights reserved.

*Corresponding authors

Keywords: induced fit; molecular docking; conformational energy; X-ray crystallography; T4 lysozyme

Supplementary data associated with this article can be found at doi: 10.1016/j.jmb.2004.02.015 Present address: A. M. Ferrari, Department of Pharmaceutical Sciences, University of Modena, Via Campi 183, Italy. Abbreviations used: L99A, Leu99 ! Ala mutant of T4 lysozyme; L99A/M102Q, Leu99 ! Ala and Met102 ! Gln double mutant of T4 lysozyme; RMSD, root-mean-square deviation; ACD, the Available Chemicals Directory; WT, wild-type; CD, circular dichroism; dUMP, 20 -deoxyuridine 50 -monophosphate; Tm, melting temperature; DCp , the difference between the isobaric heat capacity of denatured protein and that of native protein; TS, thymidylate synthase. E-mail addresses of the corresponding authors: brian@uoxray.uoregon.edu; shoichet@cgl.ucsf.edu
0022-2836/$ - see front matter q 2004 Elsevier Ltd. All rights reserved.

1162

Testing a Flexible-receptor Docking Algorithm

Introduction
Molecular docking is a structure-based computational technique that samples complementary fits of a macromolecular receptor and possible ligands. As the structures of more and more target receptors are determined,1 molecular docking is increasingly used for lead discovery, typically by screening a large database of organic molecules for putative ligands that fit a binding site.2 To do this, a docking program fits molecules in the site, often in hundreds or even thousands of orientations and conformations, evaluates their complementarity, and ranks each molecule relative to the rest of the database. Whereas the technique has had some important successes in recent years,3 ­ 10 serious challenges remain. These challenges may be divided into two categories: problems with calculating binding energies or complementarity scores, and problems with sampling the degrees of freedom available to interacting molecules. A frontier challenge facing structure-based screening is accounting for receptor flexibility. Induced fit of the receptor on ligand binding is well known, and can include a range of conformational changes, from local rearrangement of side-chains to hinge motion of domains.11 ­ 14 Even small side-chain movements can make the difference between success and failure in docking.15 Although the importance of this issue is well understood, treating it involves two difficulties: predicting the conformational changes that can occur, and actually sampling them in docking. The latter is challenging because there are many degrees of freedom available to a binding site, and the number of binding site conformations grows exponentially with them. Few docking programs are efficient enough to explicitly explore conformations of both ligand and receptor while screening a large number of ligands.2,16,17 Investigators have therefore attempted to restrict the range of conformational accommodations sampled by the receptor or to simplify its molecular description. Induced fit of flexible side-chains has been treated by optimization of torsional angles during docking18 or after approximate positions of ligand are found.19,20 Rotamer libraries21 have also been used to sample side-chain flexibility.22 ­ 24 To deal with the large number of receptor structures resulting from combination of rotamers, optimization techniques and clustering methods have been proposed.22,23 Molecular dynamics (MD) simulation can be used to sample a broader range of conformational changes, including backbone movement.25,26 Correspondingly, ensembles of experimentally determined structures have been used to calculate averaged potential energy grids of the flexible site, which were then used in the docking calculation.27 Olson et al. extended this approach by adopting different averaging methods and by applying it to structurally ordered water molecules.28 The FlexE algorithm recently introduced by Lengauer and

co-workers samples a set of discrete receptor conformations in a combinatorial fashion while incrementally building ligand into the site.29 This method can be used to treat both side-chain and backbone movements efficiently. Although most of these flexible-receptor docking methods can predict more accurate binding geometries of ligands than rigid-receptor docking, few have been tested in database screening application. An important issue is how receptor flexibility affects the ability of a docking method to distinguish ligands from a much larger list of "decoy" molecules in these screens. This is the typical situation when docking a diverse database of several hundred thousand molecules, almost all of which would not be expected to bind to a particular target. One might expect incorporation of receptor flexibility to always improve docking results, but this is not necessarily the case; sampling receptor conformations provides more opportunities not only for ligands but also for decoys to fit the receptor.2 Enriching ligands from the vast number of decoys is the first and most important problem in database screening. Here, we describe a flexible-receptor docking algorithm and investigate its use in database screens against binding sites known to undergo conformational change upon ligand binding. Like Kuntz27 and Lengauer,29 we use an ensemble of experimentally determined structures of the receptor as a template to represent the range of possible conformational changes. By relying on observed structures, we evade the problems of predicting which regions of receptor are flexible and how they may move. This confidence comes at the cost of restricting ourselves to sampling only the previously observed motions. Like Lengauer and colleagues,29 we allow flexible regions of receptor to move independently and their conformations to recombine, thus increasing the number of possible conformations beyond those directly observed. By identifying separately the best conformation of each part of the receptor for a given pose of the ligand, we hope to reduce the docking search space from one that grows exponentially with receptor flexibility to one that grows linearly. To test the method, we first dock against a cavity site in the core of T4 lysozyme. This site was originally created by substituting a core leucine residue with alanine (Leu99 ! Ala, L99A).30 This left a binding pocket that is completely buried from solvent and highly constrained geometrically, and that presents only hydrophobic surface area with which ligands can interact. Correspondingly, the L99A cavity only binds relatively small, hydrophobic ligands, typically aryl hydrocarbons, of which 56 have been characterized.31,32 Importantly for this study, the cavity can undergo significant conformational changes, ranging from movement of side-chains to unwinding of a short helix, to accommodate larger ligands. This highly simplified site removes several of the ambiguities that come when docking to more complicated sites,

Testing a Flexible-receptor Docking Algorithm

1163

Figure 1. Representative inhibitors of thymidylate synthase.

and yet retains some of the specificity determinants of these sites, making it a model binding site for testing docking algorithms (see Wei et al.33 and Morton et al.31 for further discussion). We evaluate the effects of incorporating receptor flexibility on the ability to enrich the known ligands in the database, and the ability to predict binding geometry. To explore the method in a more complicated, "drug target-like" site, we turn to the folate-binding pocket of thymidylate synthase. Thymidylate synthase (TS) is crucial to DNA synthesis in both prokaryotic and eukaryotic cells, and has been a target for the development of antimicrobial and anticancer agents.34 The enzyme catalyzes the conversion of deoxyuridine monophosphate (dUMP) to deoxythymidine monophosphate (dTMP) by a reductive methylation involving N5,N10-

methylenetetrahydrofolate as a cofactor. Several diverse classes of inhibitors targeting the folatebinding site have been discovered, including folate analogs, O-dansyl-L -tyrosine derivatives, and phenolphthalein derivatives (Figure 1). Upon binding the cofactor, several parts of TS make large, segmental accommodations.35 This inherent protein flexibility has been harnessed by some inhibitors, such as BW184336 and N,O-didansyl-L tyrosine.37 Unlike the cavity sites that always expand to accommodate larger ligands, this solvent-exposed binding pocket often "closes" down onto its ligands. Finally, to test whether genuinely new ligands can be discovered using the flexible receptor method, we turn to a modified, polar version of the lysozyme cavity site, in which a methionine

Figure 2. Scaling of the computational time for flexible receptor docking as the number of binding site conformations increases. L99A cavity (diamond) and the folatebinding site of thymidylate synthase (triangle) were screened either by flexible-receptor docking of an ensemble of receptor conformations (open symbols), or by sequential calculations for each conformation (filled symbols). Randomly selected subsets of the ACD were used in these calculations.

1164

Testing a Flexible-receptor Docking Algorithm

residue on the wall of the cavity was replaced with glutamine (mutant enzyme L99A/M102Q).33 We assume that this site can undergo the same conformational changes observed for the L99A cavity, and created a conformational ensemble based on the structures of the latter. Thus, in this system, we do not use previously observed conformations to calculate the ensemble, rather we draw upon conformational changes in the almost identical cavity L99A. We would expect this to be a conservative approximation. We screen a database against this polar cavity, and look for molecules predicted to cause conformational changes in the cavity and to hydrogen bond with the substituted glutamine. Those molecules are tested for binding and their bound-structures are then determined by X-ray crystallography. Predicted geometries of those complexes can be compared to the experimental result, affording a relatively rigorous test of the method.

fewer ligands were found when docking the apo cavity: 54% of ligands were found in the top 1.5% of the ranked database, compared to 77% of ligands when docking the isobutylbenzene-bound conformation (Figure 3a). This is expected, since the isobutylbenzene-bound conformation is simply an enlarged version of the apo cavity. However, among the highest-ranking molecules, which are arguably the most important for database screening, docking the apo cavity gave better enrichment than docking the isobutylbenzene-bound cavity: in the top scoring 300 molecules, 13 ligands were found by docking the apo conformation versus

Results
Computational efficiency To test the efficiency of the algorithm, docking screens were conducted against two sites: a buried, hydrophobic cavity in T4 lysozyme (L99A mutant) and the folate-binding pocket of thymidylate synthase. Randomly selected subsets of the Available Chemicals Database (ACD) were docked against an ensemble of receptor conformations, and the run time was compared to that of docking the same databases to each receptor conformation sequentially. Since the number of receptor conformations increases exponentially with the degrees of freedom, the computational cost of sequentially docking against all conformations rises correspondingly (Figure 2). Conversely, using the ensemble algorithm the cost grows almost linearly with the degrees of freedom. The advantage of the ensemble algorithm increases as more receptor conformations are sampled. For example, sequential docking of 12 conformations of the L99A cavity took over 19 hours, whereas the flexible-receptor calculation finished within three hours, a speedup of over sixfold. The speedup increased to about tenfold when docking against 24 cavity conformations, and to 18-fold when docking against 48 conformations. A similar trend was observed for thymidylate synthase (Figure 2). Docking to L99A We examined how well the 56 known ligands of the L99A cavity were enriched among the 202,383 assumed decoys in the ACD by docking against an ensemble of 12 cavity conformations. This was compared to docking against the apo conformation, representing the smallest cavity, and against the largest observed conformation, that of the isobutylbenzene-bound structure. Overall,

Figure 3. Enrichment of 56 known binders of the L99A cavity by docking 202,383 molecules of the ACD against only the apo cavity conformation (red), only the isobutyl benzene-bound site conformation (blue), or an ensemble of receptor conformations with (green) or without (orange) consideration for receptor conformational energy. (a) The cumulative percentage of known binders versus the percentage of the rank-ordered database. For instance, the 1% point on the X-axis means the top 1% of the ranked database. The black line shows the enrichment expected from a random selection. (b) The ranks of 12 known ligands by the four different docking calculations (same color scheme). The binders are separated on the basis of molecular size.

Testing a Flexible-receptor Docking Algorithm

1165

only six ligands by docking the isobutylbenzenebound conformation. Correspondingly, the enrichment factors, which measure the number of known ligands in the top-ranked list relative to a random selection (see Materials and Methods), were 151 versus 70, respectively. Surprisingly, the result of docking the conformational ensemble (Figure 3, orange line) closely resembled that of docking the isobutylbenzenebound conformation alone (Figure 3, blue line). Relatively large molecules that can only be accommodated by the isobutylbenzene-bound conformation received better van der Waals energies than the smaller molecules that fit well to the smaller cavity conformations. These large molecules thus dominated the top-ranking molecules list. Whereas some of these larger molecules were true binders, others (such as 3-methoxymethylindole, D -camphor, and acenaphthylene) do not appear to bind when tested experimentally (A. P. Graves & B.K.S., unpublished results).31 We wondered whether this domination by large molecules would be lessened by considering the cost of deforming the apo cavity to the larger, isobutylbenzene-bound conformation. We added a term into the scoring function to account for receptor conformational energy relative to the apo conformation, based on the observed linear correlation between the stability of cavity

mutants and cavity size (see Materials and Methods).38 Adding this correction to the flexiblereceptor treatment significantly improved the docking result (Figure 3, green line). More ligands (16) were ranked within the top 300 when applying the correction, than when docking the apo conformation (13 ligands) or when docking the isobutylbenzene-bound cavity (six ligands). This remained true further down in the ranked list, reflecting contributions of both smaller and larger cavity conformations sampled (Figure 3(a)). Correspondingly, the large decoys found when searching without the correction term (e.g. acenaphthylene) were ranked much worse. Next we examined the ranks of 12 characteristic ligands, half of which are relatively small and half are large (Figure 3(b)). Sampling only the apo conformation ranked the six smaller ligands in the top 1000 molecules, but none of the bigger ones. Conversely, all the six larger ligands were found when docking the large cavity conformation, but only two of the smaller ones ranked above 1000 and these only barely so. Similar results were obtained when docking the flexible-receptor without correction for the conformational energy difference. Adding this correction led to all six smaller ligands and four larger ones ranked within the top 1000 scoring molecules (Figure 3(b)).

Figure 4. Enrichment of 239 known inhibitors of thymidylate synthase by docking the ACD against the apo structure (red), the methotrexate-bound ternary structure (blue), the BW1843-bound ternary structure (magenta), or an ensemble of 18 conformations with (green) or without (yellow) correction for receptor conformational energy difference. (a) The cumulative percentage of known binders is plotted against the percentage of the rank-ordered database. The black line shows the enrichment expected from a random selection. (b) Venn diagram showing the overlaps among the inhibitors (indicated by the numbers) ranked in the top 10% of the database when docking to the apo conformation (red circle), the methotrexatebound conformation (blue circle), or the BW1843-bound conformation (magenta circle). (c) Venn diagram showing the overlap between the set of inhibitors ranked in the top 10% of the database when docking to a flexible receptor with consideration of receptor conformational energy differences (green circle) and the set of inhibitors ranked in the top 10% of the database when docking to any one of the three observed conformations (black square, which is the union of the three circles in (b)).

1166

Testing a Flexible-receptor Docking Algorithm

Figure 5(a) ­ (c) (legend opposite)

Docking to thymidylate synthase To investigate the role of receptor flexibility in a realistic drug target site, we turned to the folate binding site of TS, which has been extensively studied for drug design.37,39 The conformations of three flexible parts of the enzyme (composed of residue Phe176, residues Val77 through Trp83, and residues Asp169, Tyr209, and Pro261 through Ile264, respectively), observed in three different crystal structures, were recombined to generate 18 different receptor structures. The experimental

structures used were that of a binary complex with 20 -deoxyuridine-50 -monphosphate (dUMP, PDB entry 1BID), which we consider an "apo" structure, and two ternary complexes, one with the antifolate BW1843 (PDB entry 1SYN) and a second with the antifolate methotrexate (PDB entry 1AXW). Unlike the cavity site, when TS binds ligands the folate site closes down to a smaller conformation. ° In the BW1843-bound complex 195 A2 of nonpolar surface area are lost, and in the metho° trexate-bound complex an additional 206 A2 are

Testing a Flexible-receptor Docking Algorithm

1167

lost. On the other hand, the calculated electrostatic self-energy increases (becomes less favorable) as charged residues are brought closer together upon inhibitor binding. This energy is the lowest for the apo conformation, is 8.5 kcal/mol higher for the methotrexate-bound structure, and is 37.7 kcal/mol higher for the BW1843-bound structure (inhibitors are removed in these calculations). Thus it appears that during the closure of the active site, a favorable reduction of non-polar surface is often balanced by an unfavorable increase of electrostatic energy. Because we have no experimental basis for assigning relative conformational energies, we assumed that these two opposing terms predominate in the conformational energy change of TS, and used their linear combination to estimate the change. A scaling term of 0.020 kcal/ ° A2 per mol,40 was used to calculate the energetic contribution of burial of non-polar surface. The sum of the electrostatic term and the non-polar surface area term was arbitrarily scaled by a factor of 0.25 to bring its magnitude in line with those of the docking energy scores. Thus, relative to the apo conformation, the methotrexate-bound conformation had a conformational energy of þ 0.1 kcal/mol and the BW1843-bound conformation an energy of þ 8.4 kcal/mol; overall, the 18 conformers sampled in the flexible-receptor docking calculation spanned a relative conformational energy range of 6.9 kcal/mol. We note that the conformational ensemble was constructed using the rigid fragment taken from the methotrexate-bound structure and the flexible fragments from all three structures. Thus, only one observed structure (PDB entry 1AXW) was explicitly in the ensemble,

Figure 5. Stereo views of thymidylate synthase in complex with (a) BW1843 and (b) ZD1694 (see Figure 1) predicted by docking to an ensemble of 18 enzyme conformations (carbon atoms in green) compared to the corresponding crystallographic structures (carbon atoms in

light gray) and the apo structure (carbon atoms in orange). The docking-predicted conformations of the ligands and Phe176 are shown, with Phe176 of the apo structure also shown as a reference. Oxygen atoms are colored red, nitrogen atoms in blue. (c) An example of incorrect ligand geometry due to docking against a rigid receptor conformation, in this case that of the methotrexate complex (carbon atoms in magenta). In this structure, Phe176 adopts a conformation different from that in the BW1843-bound structure (carbon atoms in light gray). This leads to large RMSD and unfavorable energy score for BW1843 (docked ligand carbon atoms in green). (d)­ (g) An example of a known inhibitor that failed to be ranked in the top 10% of the database in any of the three crystal structures, and yet was so ranked by the flexible-receptor model. The predicted binding mode of compound 4 (carbon atoms in green) would cause steric clashes in the apo structure ((d) carbon atoms in orange), in the methotrexate-bound structure ((e) carbon atoms in magenta), and in the BW1843bound structure ((f) carbon atoms in cyan). (g) It was best complemented when two flexible parts were in their apo conformation and the rest of the protein adopted their methotrexate-bound conformation. Broken lines indicate steric clashes; the numbers nearby are the ° atomic distances in A. The molecular graphics were rendered with neon in MidasPlus,59 as were Figures 7 and 8.

1168

Testing a Flexible-receptor Docking Algorithm

Table 1. Testing 18 new docking-predicted ligands for binding to L99A/M102Q by thermal denaturation upshift experiments
L99A/M102Q Compound 2-Isopropyl phenol Structure Drank
a

Dscore (kcal/mol) 64

a

[L] (mM) 2.5

DTm b 1.7

Bind? Yes

8353

2-Allyl phenol

4653

23

2.5

5.4

Yes

2-n-Propyl phenol

2226

28

2.5

7.4

Yes

2,6-Dichloro-4-fluoro phenol

2805

14

2.5

2.3

Yes

2,6-Dimethyl phenol

2017

11

1.25

3.9

Yes

4-Fluoro phenethyl alcohol

1398

8

10

2.4

Yes

2-Phenyl ethanol

273

4

10

2.8

Yes

Acetanilide

NAc

NAc

5

1.4

Yes

2-Chloro-6-methyl aniline

816

6

2

1.0d

Yes

3-Fluoro-2-methyl aniline

73

2

2

2.2d

Yes

2-n-Propyl aniline

1655

18

1

1.8e

Yes

N-Allyl aniline

1693

10

2

2e

Yes

3-Fluoro phenethyl alcohol

1551

8

5

2.9

Yes

2-Allyl-6-methyl phenol

3582

26

2.5

5.2

Yes

2-Ethyl thiophenol

3573

18

1.25

20.1

No

2-Amino benzylcyanide

1480

9

1

0.2e

No (continued)

Testing a Flexible-receptor Docking Algorithm

1169

Table 1 Continued L99A/M102Q Compound 2-Anilino ethanol Structure Drank 3071
a

Dscore (kcal/mol) 15

a

[L] (mM) 2

DTm b 0.2e

Bind? No

N-(o-Tolyl) cyanoformamide
a

NAc

NAc

2

20.3

No

Relative to docking against the apo conformation. The difference in protein melting temperature between in the presence and in the absence of compound. Standard deviation is 0.2 deg. C; measured at pH 3.0 unless specified otherwise. c Not applicable because they could not fit the apo cavity conformation without steric clash. d Measured at pH 5.4. e Measured at pH 6.8.
b

though the other two crystallographic structures were closely represented (see Materials and Methods). The energy differences among the conformations are meant to reflect the general trend that ligand-bound conformations have higher energy than the apo conformation does; we have not optimized these correction terms. A significant improvement in enrichment factor was observed when applying this conformational energy correction (Figure 4(a)). Without considering enzyme conformational energy differences, 50.6% of known inhibitors were found in the top 10% of the ranked database by docking an ensemble of 18 receptor conformations, while less than half that many inhibitors were enriched in the top 10% of the database by docking any one of the three observed receptor conformations. However, in the critical top 1% of the ranked list, the enrichment afforded by docking a flexible receptor without correction for conformational energy (13.6% of inhibitors) was actually worse than that (14.9%) resulting from docking the BW1843-bound receptor conformation alone (Figure 4(a)). Applying the correction improved not only the enrichment in the top 10% of the ranked list, to 55.7% of inhibitors, but also that in the top 1% of the database, to 19.6% of inhibitors. Predictions of binding geometry and induced protein conformational changes were examined for two inhibitors whose structures in complex with TS were known: BW184341 and ZD1694.42 Docking the inhibitor BW1843 against the conformational ensemble led to a correct binding mode and a correct conformation of Phe176 (Figure 5(a)). On the other hand, docking against the methotrexate-bound conformation alone, in which the active site adopts a more closed conformation, this ligand received a much worse score and its predicted geometry was incorrect (Figure 5(c)). Unlike BW1843, the complex of ZD1694 (PDB entry 2KCE) was not among the three crystallographic structures used to construct the ensemble (the apo, the methotrexate-bound, and the BW1843-bound structures). Docking to the flexible receptor, the binding mode of the inhibitor ZD1694 was

° predicted to within an RMSD of 1.3 A, excluding the solvent-exposed glutamate moiety of the inhibitor (Figure 5(b)). The predicted movement of Phe176 was also observed. Conversely, when docking to any one of the three crystallographic structures, only incorrect poses of the inhibitor with unfavorable docking energies were found. We wondered if the inhibitors ranked well by flexible-receptor docking were merely a union of those inhibitors ranked well by docking to the three observed binding site conformations of which the conformational ensemble was composed. In all, 33 of the known inhibitors that were ranked in the top 10% of the database by flexiblereceptor docking were absent from the top 10% lists from docking any of the three observed conformations (Figure 4(c)). Conversely, except for six molecules, all of the known inhibitors found in the top 10% of the database ranked by docking against any one of the three crystallographic structures were also found in the top 10% ranked by docking against the flexible receptor with conformational energy correction. For example, compound 4 (Figure 1) ranked 194 (score 2 64 kcal/mol) by the flexible-receptor treatment, whereas it ranked 64,705 (score 2 23 kcal/mol) in the apo conformation, ranked 130,067 (score 2 6 kcal/mol) in the methotrexate-bound conformation, and could not fit the BW1843-bound conformation without steric clash. In the predicted complex, compound 4 adopts a pose similar to that observed for methotrexate, placing its cyclopentaquinazoline moiety where the 2,4-diaminopterine group of methotrexate binds (Figure 5(g)). However, comparing to the methotrexate-bound structure, two mobile parts of the protein were predicted to adopt their conformations observed in the apo structure, in order to accommodate the bulkier cyclopentaquinazoline group. Similarly, N,O-didansyl-L -tyrosine ranked 7060 (score 2 40 kcal/mol) in the flexible-receptor model, whereas it was ranked no better than 82,169 (score no better than 2 18 kcal/mol) when docked against any of the three PDB structures individually. At least for TS, docking against the ensemble of receptor

1170

Testing a Flexible-receptor Docking Algorithm

Table 2. X-ray data collection and refinement
Ligands bound to L99A/M102Q 2-Allyl phenol Cell dimensionsa ° a ¼ b (A) ° c (A) ° Resolution (A) Reflections Rmerge (%) Completeness (%) kIl/ks(I)l R-factor (%) ° Res. range (A) ° Dbond lengths (A) Dbond angles (deg.) PDB code
a b

2-Allyl-6methyl phenol 60.8 97.4 1.9 (2.0) 15,008 (2206) 8.1 (16.0) 89 (67) 10.0 (2.1) 18.9 13.0­2.0 0.017 2.7 1OV7

2-Chloro-6methyl aniline 60.7 97.2 1.95 (2.1) 14,679 (2676) 8.0 (16.1) 93 (87) 11.2 (2.3) 18.5 13.0­1.95 0.017 2.8 1OVH

3-Fluoro-2methyl aniline 60.7 97.5 1.9 (2.0) 15,186 (2280) 8.0 (13.8) 90 (68) 10.6 (2.5) 19.7 13.0­2.0 0.018 3.0 1OVJ

N-Allyl aniline 60.8 97.2 2.1 (2.26) 11,599 (1893) 9.5 (19.8) 92 (76) 8.4 (1.8) 18.3 13.0­2.1 0.017 2.8 1OVK

2-n-Propyl aniline 60.7 97.5 1.9 (2.0) 15,141 (2303) 6.2 (16.3) 90 (70) 13.4 (2.4) 17.6 13.0­1.9 0.016 2.7 1OWY

4-Fluorophenethyl alcohol 60.8 97.2 1.9 (2.0) 15,037 (2180) 7.4 (14.6) 89 (66) 11.2 (2.3) 18.7 13.0­1.9 0.015 2.8 1OWZ

60.8 96.9 2.1 (2.26)b 8950 (1145)b 6.2 (17.1)b 74 (52)b 6.7 (1.4)b 18.4 13.0­2.1 0.016 2.6 1OV5

° ° Cell dimensions of the apo L99A/M102Q are: a ¼ b ¼ 60.8 A, c ¼ 97.0 A. Values in parentheses are for the highest resolution shell.

conformations resulting from recombination of the flexible parts is better than simply merging the results from docking to the three observed conformations from which the ensemble was built. Docking to L99A/M102Q We wanted to test the conformational energycorrected algorithm prospectively, by predicting and experimentally testing genuinely new ligands for a polar mutant of the lysozyme cavity site, L99A/M102Q.33 All of the previously observed structures of L99A/M102Q33 closely resemble the apo conformation of the cavity, presumably because all of the ligands in these structures are small. We hypothesized that L99A/M102Q could undergo conformation changes similar to those observed for L99A. An ensemble of L99A/M102Q conformations was computed by computationally "mutating" Met102 to Gln in the conformational ensemble of L99A. Thus, observed conformational changes in a highly similar site were treated as movements that would also occur in this system. We also introduced an alternative conformation of Val103 into the ensemble, based on a rotamer library. A total of 24 conformations of the L99A/ M102Q cavity were thus sampled. Conformational energy differences relative to the apo structure were calculated with the same method used for L99A. We looked for high ranking docked molecules that satisfied three criteria: (1) they were scored and ranked significantly better in a non-apo conformation than in the apo conformation; (2) in the predicted binding mode they hydrogen bonded with Gln102; (3) they were dissimilar to the known inhibitors of L99A/M102Q.33 A total of 18 docking hits were selected and tested for binding to L99A/M102Q using thermal denaturation upshift experiments.31 Of the 18 predicted ligands, 14 caused a signifi-

cant increase of the melting temperature of L99A/ M102Q, indicating that these compounds bind to the protein, whereas four molecules did not appear to bind (Table 1). The enrichment of these ligands and the 63 previously known ligands31 ­ 33 was compared between rigid-receptor and flexible-receptor docking treatments. Similar to what was observed in docking L99A, flexible-receptor docking with conformation energy correction gave the best enrichment overall; without the correction, the result was dominated by the largest cavity conformation, leading to poor enrichment in the top percentages of the ranked database (data not shown). The bound structures of seven of these new ligands were subsequently determined by X-ray crystallography (Table 2, Figure 6). Each complex structure was routinely solved and refined using the apo-structure as the starting model. All contents of the cavity were removed from the starting model to avoid bias to the subsequent difference electron density maps that were used to identify the mode of ligand binding to the cavity. In each of the seven complex structures, clear difference electron density within the cavity was observed. In each case, the docking-predicted position of the ligand agreed well with the electron density map, which allowed the predicted ligand model to be used as the starting model for refinement of the contents of the cavity. In no case was electron density observed that suggested the presence of an ordered water molecule; such a water molecule was found in the apo-structure and the phenol-bound structure.33 In the seven new structures described here, the major component of non-isomorphism was the movement of helix F (residues 108 ­ 116) away from the cavity. This helix has previously been observed to have higher mobility than other portions of the cavity surface and has been suggested as the location of access to the cavity from the bulk solvent.43,44

Testing a Flexible-receptor Docking Algorithm

1171

Figure 6a ­ c (legend on p.1173)

We compared the predicted ligand-binding geometries to the crystallographic results. All ° seven ligands were predicted to within 0.7 A RMSD from the crystallographic structures (Table 3). The largest error occurred with 4-fluorophenethyl alcohol, which caused significant movement of Gln102, a residue assumed to be rigid in the calculation. The overall orientations of the ligands and their hydrogen bonds to the OE1 of Gln102 were correctly predicted in all seven cases. This would not have occurred had we docked to the rigid, apo cavity. For instance, helix

F moved upon binding of 2-chloro-6-methyl aniline, making room for the 6-methyl group. With the flexible-receptor treatment, the ligand ° was predicted to within 0.5 A RMSD (Figure 7e). In the apo conformation, however, the methyl group could not be correctly placed because of steric clash, and an incorrect orientation of the ligand was favored (Table 1, Figure 8(a)). A similar result occurred with 3-fluoro-2-methyl aniline (Figure 8(b)). For the other five ligands the docked energies against the apo conformation were so unfavorable, owing to steric

1172

Testing a Flexible-receptor Docking Algorithm

Figure 6d ­ f (legend opposite)

clashes, as to make geometrical comparison problematic. We also compared the predicted and observed conformational changes in the cavity site. Qualitatively, the predicted movements were observed for five of the seven ligands (Table 3 and Figure 7). In addition to the predicted movements, additional accommodations were often observed. For example, Leu118 was predicted to move upon binding of 2-n-propyl aniline to accommodate the propyl group. Indeed, a movement of ° more than 0.5 A from the apo structure was observed in the complex. In addition, Val103,

° Val87 and helix F also moved by about 0.3 A in this complex, which had not been predicted (Figure 7a). In the 3-fluoro-2-methyl aniline-bound complex, helix F was proposed to move away from the cavity to make room for the methyl group. This was confirmed by the observation of a ° movement of the helix over 1.0 A (Figure 7c). Here ° movement of Leu84 occurred in the again, a 0.6 A experimental structure but had not been predicted. For 2-allyl-6-methyl phenol, changes of Leu118 and helix F as well as an alternative rotamer of Val103 were predicted, but only the movement of the helix was actually observed (Figure 7b).

Testing a Flexible-receptor Docking Algorithm

1173

Figure 6. Stereo views of difference electron density maps for seven ligands bound to L99A/M102Q. a, 2-n-Propyl aniline; b, 2-allyl-6-methyl phenol; c, 3-fluoro-2-methyl aniline; d, 2-allyl phenol; e, 2-chloro-6-methyl aniline; f, 4-fluorophenethyl alcohol; and g, N-allyl aniline. The coefficients are ðFo 2 Fc Þ; where the Fo are the observed structure amplitudes for the ligand-bound complex and the Fc and phases were calculated from the refined model with all atoms removed from the cavity. Maps are contoured at þ3s (continuous lines) and 2 3s (broken lines).

For the other two ligands, N-allyl aniline and 4-fluorophenethyl alcohol, binding caused unexpected conformational changes of the cavity (Table 3 and Figure 7). In the N-allyl anilinebound structure, Gln102 and Phe114, both of

which were assumed rigid in the conformation ° ° ensemble, moved by 0.4 A and 0.3 A, respectively (Figure 7g). In the 4-fluorophenethyl alcohol° bound complex, Gln102 moved by 0.6 A, as did helix F (Figure 7f).

Table 3. Comparison of prediction to crystallographic structures
RMSD of predicted ligand from X-ray structure ° (A)

Name

Structure

Predicted protein movement

Observed protein movementa

2-n-Propyl aniline

0.5

L118

L118, helix F, V103, V87

2-Allyl phenol

0.3

L118

L121, helix F, L118, V103

3-Fluoro-2-methyl aniline

0.5

Helix F

Helix F, L84, F114, V103, I78, Q102

N-allyl aniline

0.6

L118

Q102, F114

4-Fluoro-phenethyl alcohol

0.7

L118

Q102, helix F

2-Allyl-6-methyl phenol

0.6

V103, helix F, L118

Helix F, L121

2-Chloro-6-methyl aniline

0.5

Helix F

Helix F, L84, L121, V87, V103, F114, L118

a

° RMSD . 0.3 A, in order of decreasing magnitude.

1174

Testing a Flexible-receptor Docking Algorithm

Figure 7a ­d (legend opposite)

Discussion
Perhaps the most generally useful result to emerge from these studies is the importance of

receptor conformational energy in docking to flexible receptors. When this energy is ignored, especially in the lysozyme cavity sites of L99A and L99A/M102Q, many known ligands are

Testing a Flexible-receptor Docking Algorithm

1175

Figure 7. Stereo pictures comparing the apo (carbon atoms in yellow), predicted (carbon atoms in green), and crystallographically observed (carbon atoms in gray) structures of L99A/M102Q in complex with a, 2-n-propyl aniline; b, 2-allyl-6-methyl phenol; c, 3-fluoro-2-methyl aniline; d, 2-allyl phenol; e, 2-chloro-6-methyl aniline; f, 4-fluorophenethyl alcohol; and g, N-allyl aniline. For the predicted structures, only the ligands and the parts of the cavity that were predicted to move are shown. Oxygen atoms are colored red, nitrogen atoms in blue, halogen atoms in magenta. The parts of the protein for which conformational changes were predicted are circled.

ranked poorly because of competition from the decoys that happen to complement higher-energy receptor conformations. In the cavity sites, these large decoys are at an advantage because they can fit a larger cavity conformation, often through improved van der Waals interactions and hydrophobic effects, without paying the energetic cost of distorting the site from its low-energy, apo conformation. When the receptor conformational energy is considered these decoys are discriminated against in favor of known ligands. At the same time, the conformation energy cost is not so

high as to prevent known large ligands from being enriched through complementation of larger sites. In these model docking sites, the role of a receptor conformational energy term can be seen clearly owing to the simplicity of the sites and to considerable previous work on the cost of cavitation in proteins in general and in T4 lysozyme in particular. A more nuanced situation was encountered in docking to thymidylate synthase. Unlike the cavities, docking the ensemble of TS conformations improves enrichment significantly even without a

1176

Testing a Flexible-receptor Docking Algorithm

Figure 8. Docking against the apo L99A/M102Q cavity (PDB entry 1LGU) led to incorrect prediction of the binding geometry of a, 2-chloro-6-methyl aniline and b, 3-fluoro-2-methyl aniline. Color scheme is the same as in Figure 7. The pictures are in stereo.

conformational energy correction. Two reasons may be proposed for this difference. First, the origin and magnitude of the conformational energy term for the TS site is less clear than for the cavities. Second, the three different conformations of TS represented in the ensemble each select different ligands, with only limited overlap between them (Figure 4(b)). For instance, 19 inhibitors found in the top 10% of the ranked database from docking to the methotrexate-bound conformation are absent from the top 10% lists from either docking to the BW1843-bound conformation or docking to the apo-conformation. When the three conformations are recombined in the ensemble, all of these ligands still score well, because they fit to a particular conformation in the ensemble, and most are still ranked well. This situation differs from that found in the cavity sites, where all the ligands can fit to the largest cavity conformation but only some to the smaller conformations. Thus TS may be a sort of best-case ¨ scenario for naive, un-weighted multi-conformer docking, in that the ensemble captures a union of the observed component conformations, which themselves have largely non-overlapping ligand preferences. Nevertheless, even for TS, a conformational energy correction improves the ability to distinguish known ligands from decoys. Some of the challenges and opportunities of docking to a flexible receptor are illustrated by the prospective docking predictions against the polar

cavity mutant L99A/M102Q. In this site, the possibilities for extensive conformational change are relatively limited and we had a good analogy for what to expect based on the changes observed in the L99A cavity site.43 Even so, we often observed unexpected accommodations of the receptor. These changes had not been observed previously and thus were not included in our energyweighted conformational ensemble. What would seem to make predicting these changes difficult is that few of them corresponded to rotamer changes, which are probably the most straightforward to calculate. Rather, they reflected combinations of torsional changes and main-chain movements. Even for well-studied sites, predicting new conformational changes remains a frontier area of research. Despite these cautionary observations, several hopeful features emerge from these studies. By sampling receptor flexibility, genuinely novel ligands of L99A/M102Q were discovered; most of these molecules would not have been found by docking against any single receptor conformation. The binding modes of these ligands were predicted ° to within 0.7 A RMSD from the experimental structures subsequently determined. In most cases, at least part of the corresponding conformational changes in the protein sites were also correctly predicted. The runtime of the algorithm scales linearly with the degrees of freedom of the receptor, making it feasible to dock a database of many

Testing a Flexible-receptor Docking Algorithm

1177

molecules to a large number of receptor conformations. Whereas restricting oneself to experimentally observed conformations of a receptor is certainly limiting, it does allow one to sample conformations reached through a combination of movements that could not be found with the simpler methods of sampling conformational change. Moreover, these experimentally observed structures have the virtue of being energetically accessible. Finally, whereas we do not claim that our methods to estimate receptor conformational energy are generally applicable, our results strongly suggest that some way of accounting for the internal energy differences among those conformations will be an important component in scoring functions for docking against flexible receptors.

Eelec ¼

L X i[L

qi fi Aij Bij 2 6 r12 rij ij
L X i[L

ð2Þ ! ð3Þ

Evdw ¼
L X i[L

L R XX i[L j[R

DGL ¼ solv

DGi Fi ¼

DGi

R X j[R

fij

0 # Fi # 1 ð4Þ

DER ¼ aðVconf 2 Vapo Þ or conf DER ¼ bðTEconf 2 TEapo þ cðNPconf 2 NPapo ÞÞ conf

ð5Þ

Materials and Methods
The algorithm The docking program is a modified version of DOCK that we have developed over several years;32,45,46 we will refer to this version as DOCK3.5.54. To account for conformational flexibility of receptor, ligands are docked against an ensemble of distinct receptor conformations. We assume that the mobile regions (for example, sidechains or loops) of the receptor move independently and thus the combinations of those movements give rise to an ensemble of receptor conformations. To the extent that this is true, the conformational ensemble can be described by a composite representation: one conformation of the rigid part, multiple conformations of each of the flexible parts. As in the previous implementations of DOCK, multiple orientations of each database molecule are sampled in the binding site by matching to hot spots in the binding site ("spheres"). Given a certain configuration of a ligand, its complementarity can be calculated based on its interaction with the independent receptor parts. The interaction is evaluated using a three-dimensional grid. For each component of the composite representation, four grids were computed to store excluded volume,47 van der Waals potential,47 electrostatic potential48 and context-dependent ligand desolvation (B.Q.W. & B.K.S., unpublished results). For each ligand configuration, a depth-first search is first performed to check if at least one-receptor conformations can accommodate the ligand without steric clash. If so, the ligand is then scored for each component of the composite representation. The optimal receptor conformation is assembled using the best-fit conformation of each flexible receptor region (Figure 9(a)). As the number of flexible receptor regions increases, the number of receptor conformations will grow exponentially while the number of the components grows only linearly. Thus the complexity of the algorithm increases linearly with receptor degrees of freedom. This algorithm requires the contribution by every receptor part to the docking score to be evaluated independently. The docking scoring function is: E ¼ Eelec þ Evdw 2 DGL 2 DER solv conf ð1Þ

The electrostatic interaction energy ðEelec Þ is calculated as the sum over the partial charge ðqi Þ of every ligand atom i; multiplied by the electrostatic potential of the receptor ðfi Þ at the respective atomic position.47 The electrostatic potential ðfi Þ is calculated using DelPhi.48 The van der Waals contribution ðEvdw Þ is the sum over the van der Waals properties of each ligand atom multiplied by the Lennard ­ Jones potential of the receptor, calculated by CHEMGRID.47 The desolvation penalty for each ligand ðDGL Þ is the sum over solvation energy ðDGi Þ of ligand solv atom PR i, multiplied by a normalization factor ðFi ¼ j[R fij Þ that accounts for the extent to which ligand atom i is buried by the binding site. DGi is calculated using AMSOL49,50 before docking and fij is computed based on the volume of the receptor atom j and its distance from the position where ligand atom i is placed (B.Q.W. & B.K.S., unpublished results). For the lysozyme cavities, the factor Fi is set to 1 because ligands are almost completely desolvated by the protein.33 To a good first-approximation, all of these terms may be calculated separately for each part of the receptor and then recombined additively, except for the electrostatic potential energy term. Electrostatic potential calculated by the finite difference Poisson ­ Boltzmann (FDPB) method depends on not only the distribution of charges but also the dielectric environment. When calculating the electrostatic potential grid of one receptor part, only the atoms of that part are considered to bear partial charges; the atoms of the other parts are neutral but occupy the space to define the low dielectric region. Thus computing the electrostatic potential grid of one part requires knowing the conformations adopted by all the other parts. If the other part is the rigid part, its position is defined. If it is a flexible part, then one of its conformations is selected. Here, we chose the conformation observed in the apo receptor structure. In doing so, we assume that the effect on the electrostatic potential grid of one receptor part by movement of the other parts is negligible. This assumption is correct when the two parts are far enough apart. We estimated the cutoff distance at which the effect becomes negligible using a simplistic model (Figure 9(b)): sphere Q bearing a charge of þ1 electron is placed at the origin, and an uncharged sphere R is placed at some distance from Q. The two spheres are of low dielectric ð1 ¼ 2Þ; mimicking two receptor parts. They are surrounded by bulk solvent with a dielectric of ° 78. Radii of both spheres are set to 1.65 A. Using DelPhi with standard parameters, we calculated Q's electrostatic potential at the postion P; which lies on the line connect° ing Q and R and is 2 A from Q, while changing the distance of R from Q (Supplementary Material, Figure 1). When the distance between the center of R and the

1178

Testing a Flexible-receptor Docking Algorithm

Figure 9. (a) A cartoon illustrating the algorithm. The receptor is decomposed into three parts: one rigid (green) and two flexible parts (red and blue). In this cartoon, the receptor conformational ensemble is thus composed of seven components: one conformation of the rigid part, three conformations of the red part, and three conformations of the blue part. For a given orientation and conformation of a ligand (orange), instead of sequentially evaluating its complementarity to each of the nine receptor conformations, its complementarity to the seven components is calculated, and the best-fit receptor conformation is constructed from those components. (b) A simplistic model to estimate the cutoff distance at which the electrostatic potential grids of two receptor parts become independent.

° ° center of Q varied from 5.8 A to 30 A, the change of charge Q's electrostatic potential at position P was less than 14.1 mV. Thus, if an electron unit of charge was placed at position P; the difference in electrostatic energy was less than 0.33 kcal/mol, which we considered negligible. When the two spheres come closer ° than 5.8 A, the effect of the low dielectric volume of R on the potential of Q at position P becomes more pronounced; this cutoff distance appeared insensitive to Q's charge. To explore this issue further, we also tested the feasibility of recombining electrostatic potential grids in a typical binding site, the methotrexate-binding site in dihydrofolate reductase (PDB entry 3DFR). Electrostatic interaction energies calculated by additive recombination of the flexible parts were compared with calculation of electrostatic energies using the exact conformations of the receptor. Here again, the errors introduced were neg° ligible if the 5.8 A distance constraint was satisfied (data not shown). Docking to L99A and L99A/M102Q Nine crystal structures of L99A in complex with ligands43 were superposed and examined for conformational changes of the cavity upon ligand binding. Most buried core residues that were not involved in ° binding differed by less than 0.18(^ 0.03) A (pairwise RMSD relative to the benzene-bound structure), whereas helix F, Leu118, and Leu84 moved significantly from structure to structure; the maximum RMSD values are ° ° ° 1.83 A, 0.69 A, and 0.47 A, respectively. RMSD values

were calculated using the non-hydrogen atoms of the side-chains except for helix F, where all non-hydrogen atoms of the three residues G110, V111, and A112 were used. These residues were treated as the mobile portions of the conformational ensemble, and the rest of the protein was treated as rigid. The benzene-bound structure (PDB entry 181L), the p-xylene-bound structure (PDB entry 187L), the indene-bound structure (PDB entry 183L), and the isobutylbenzene-bound structure (PDB entry 184L) of L99A were chosen to represent the whole conformational ensemble. The ensemble was decomposed into four parts: (1) Glu108 through Asn116 (helix F), one conformation from each of structures 181L, 184L and 187L (three conformations in total); (2) Leu84, one conformation from each of structures 181L and 183L (two in total); (3) L118, one conformation from each of structures 181L and 184L (two in total); (4) the rest of the protein defining the rigid part, the conformation from the PDB structure 181L. A total of 12 conformations are represented in the ensemble. We checked the conformations of these flexible parts to ensure that their recombination would not create an obvious steric clash. The spheres for ligand orientation matching used by DOCK51 were a combination of the atomic positions of some crystallographically observed ligands and the spheres calculated by the SPHGEN program;51 in total, 53 spheres were used. A distance tolerance (dislim) ° of 0.3 A was applied for matching ligands onto these ° spheres. Bin sizes and overlaps were set at 0.2 A and ° 0.1 A, respectively, for both ligand and receptor. Database molecules having less than six or more than 40

Testing a Flexible-receptor Docking Algorithm

1179

non-hydrogen atoms were skipped in docking calculation. No steric clashes with the protein, liberally ° ° defined as 2.3 A for polar ligand atoms and 2.6 A for non-polar ligand atoms, were allowed. A total of 20 steps of rigid-body minimization were conducted for the docked molecules.52 The docking database consisted of 202,383 molecules from the 2000 version of ACD. We found that the AMSOL non-polar component of solvation energy for multi-fluorinated compounds was systematically high, and we excluded from the database 3718 molecules that could have potentially been accommodated by the cavity site but had more than two fluorine atoms. Enrichment of 56 known binders of L99A (listed in Table 1 of Supplementary Material) was calculated by dividing the number of ligands found, in any given bin of the ranked database, by the number that one would expect from a random selection.33 To calculate an ensemble for the polar cavity L99A/ M102Q, we computationally substituted Met102 to Gln in the ensemble of conformations of L99A. The conformation of Gln102 was obtained from PDB entry 1LGU, which is considered as the apo conformation. In addition, we modeled an alternative conformation of Val103 using the rotamer library in the TURBO program.53 A total of 24 conformations are represented in the ensemble.

docked. No steric clashes with the protein, as defined for the lysozyme calculations, were allowed. Estimation of receptor conformational energy We explored several ad hoc methods to assess receptor conformational energy relative to the apo receptor structure ðDER Þ: For the cavity mutants of T4 lysozyme, a conf linear relationship between the stability of the mutants relative to wild-type and the size of the cavities was reported.38 Based on this, the conformational energy difference was estimated by the change in cavity volume relative to the apo cavity ðVconf 2 Vapo Þ multiplied by a coefficient a (equation (5)). The volumes of different cavity conformations were calculated by the CASTP server55 using the default parameters. The coefficient a ° was set to 0.06 kcal/A3 per mol, instead of between ° 3 per mol and 0.033 kcal/A3 per mol as pro° 0.024 kcal/A posed by Eriksson et al.,38 so that the conformational energy differences were comparable to the DOCK energy scores. We did not optimize this coefficient. The resulting conformational energies relative to the apo structure ranged between 0.78 kcal/mol and 5.46 kcal/mol. For the folate-binding pocket of thymidylate synthase, DER was the sum of the change in total electrostatic conf self-energy of receptor ðTEconf 2 TEapo Þ and the change in non-polar solvent-accessible surface area ðNPconf 2 NPapo Þ (equation (5)). Non-polar solvent-accessible areas ° were calculated by NACCESS, and 0.020 kcal/A2 per 40 mol for the energy of exposing non-polar surface was applied (coefficient c in equation (1)). Total electrostatic energies were computed using DelPhi.48 The scaling factor b was set to 0.25 so that the calculated conformational energy difference was comparable to the DOCK interaction energy scores. Comparison of run time To compare computation times, all rigid-receptor and flexible-receptor docking calculations were performed on dual 800 MHz Pentium III processors with 384 MB memory. For efficiency, randomly selected subsets of the ACD database were used in these calculations. For M102Q, the test database consisted of about 30,000 molecules and each docking calculation took between 1.2 and 4 CPU hours. For the folate binding site of thymidylate synthase, the test set consists of about 4500 molecules and each docking calculation took between 0.2 and 2 CPU hours. Binding detection by thermal denaturation upshift Thermal denaturation experiments were performed in a Jasco J-715 spectropolarimeter with a Jasco PTC-348WI Peltier-effect, in-cell, temperature-control device. A 1 cm path-length cell with in-cell stirring was used in the assays of all compounds except for N-allyl aniline and 2-n-propyl aniline, for which a 1 mm path-length cell was used. To screen the compounds for binding in their neutral forms, denaturation experiments were performed at appropriate pH values: 2-isopropylphenol, 2-allylphenol, 2-n-propylphenol, 2,6-dichloro-4-fluorophenol, 2,6-dimethylphenol, 4-fluorophenethanol, 2phenylethanol, acetanilide, 3-fluoro phenethylalcohol, 2-allyl-6-methylphenol, 2-ethylthiophenol, and N-(otolyl) cyanoformamide were assayed in a pH 3.0 buffer containing 25 mM KCl, 2.9 mM phosphoric acid and 17 mM KH2PO4; 2-n-propyl aniline, N-allyl aniline,

Docking to thymidylate synthase Crystal structures of Escherichia coli TS were superposed using buried core residues that were not involved with the folate-binding site, and the parts of the enzyme that moved significantly upon ligand binding were identified. A dUMP-bound binary structure (PDB entry 1BID) and two antifolate-bound ternary structures (PDB entries 1AXW and 1SYN) of E. coli TS were chosen to represent the entire conformational ensemble. The ensemble was decomposed into four parts: (1) Phe176, one conformation from each of the three structures (three conformations in total); (2) residues Val77 through Trp83, one conformation from each of the three structures (three in total); (3) residues Asp169, Tyr209 and Pro261 through Ile264, one conformation from each of the two structures 1BID and 1AXW (two in total); (4) the rest of the protein, which has few relevant changes among the three structures, defines the rigid part, using the coordinates from the structure 1AXW. A total of 18 conformations are represented in the ensemble. We checked the conformations of those flexible parts to ensure that their recombination would not create an obvious steric clash. The 202,383 ACD molecules together with 235 annotated TS inhibitors from the MDL Drug Data Report (MDDR, v2000) were docked against this receptor conformational ensemble, and the enrichment of the 239 known ligands (including four inhibitors present in ACD but not in MDDR: phenolphthalein, N,O-didansyl-tyrosine, O-dansyl-tyrosine, and dansyl hydrazine) was investigated. A total of 27 docking spheres were generated in the same way as for the lysozyme sites. They were labeled based on the chemical functionality of nearby residues.54 ° A distance tolerance (dislim) of 1.0 A was applied for matching ligand onto these spheres. Bin sizes and over° ° laps were set at 0.4 A and 0.3 A, respectively, for both ligand and receptor. Database molecules having less than 12 or more than 80 non-hydrogen atoms were not

1180

Testing a Flexible-receptor Docking Algorithm

2-amino benzylcyanide, and 2-anilino ethanol were assayed in a pH 6.8 buffer composed of 50 mM K3/2H3/2PO4, 200 mM KCl, and 38% (v/v) ethylene glycol; 2-chloro-6-methyl aniline and 3-fluoro-2-methyl aniline were assayed in a pH 5.4 buffer containing 100 mM NaCl, 8.6 mM sodium acetate and 1.6 mM acetic acid. Thermal denaturation in the presence of each compound, except for 3-fluoro-2-methyl aniline and 2-chloro-6-methyl aniline, was monitored by CD at a wavelength between 225 nm and 235 nm; a specific wavelength was chosen to avoid high absorbance by the compound itself. For 3-fluoro-2-methyl aniline and 2-chloro-6-methyl aniline, which absorb strongly in the far-UV region, the intrinsic fluorescence of the protein was excited by irradiation at 292 nm and thermal denaturation was measured by the intensity of the integrated emission for all wavelengths above 300 nm. Thermal melts were performed at a temperature ramp rate of 2 K/minute for the 1 cm path-length cell, and 1 K/minute for the 1 mm cell. The concentration of L99A/M102Q was 0.04 mg/ml and the concentrations of compounds were between 1 and 10 mM unless a 1 mM concentration could not be reached, in which case saturated solution was used. Each denaturation experiment was performed at least twice. A least-squares fit of the two-state transition was performed with the program EXAM56 to calculate Tm and van't Hoff DH values for the thermal melts. The DCp was set to 16 kJ mol21 K2l. L99A/M102Q appears to denature in a two-state, reversible fashion.33 Protein preparation and crystallography T4 lysozyme mutant L99A/M102Q was overexpressed, purified, and crystals grown as described.33 The crystals belong to the space group P3221. X-ray data were collected at room temperature using a multiwire area detector system.57 The protein crystal was first mounted in a capillary tube and then a droplet of the ligand introduced at one end of the tube.30 This provides a saturating vapor of the ligand which can diffuse into the crystal. The capillary tube was allowed to equilibrate overnight before data were measured. The crystal structures were refined using the TNT package.58 Determination of receptor conformational change Ligand-induced conformational changes were calculated by comparing the complexes to the apo structure of L99A/M102Q. We first chose eight buried residues that are far from the cavity site (Leu7, Ile27, Leu33, Leu46, Ile100, Trp138, Ala146, Val149), and measured the RMSD of those residues between the apo structure and ligand-bound structure. The RMSD averaged ° among all seven ligand-bound structures was 0.18 A ° with a standard deviation of 0.03 A. We therefore chose ° an RMSD of 0.3 A as the cutoff to define a significant movement of protein: for single residues, the deviation of only side-chain atoms was considered; for helix F, all atoms of the residues Gly110, Val111 and Ala112 were used. We believe that this is a conservative cutoff value, since all of the movements we considered involved coordinated motions of at least entire sidechains. Atomic coordinates The X-ray crystal structures of the complexes of

2-allylphenol, 2-allyl-6-methylphenol, 2-chloro-6-methylaniline, 3-fluoro-2-methylaniline, N-allylaniline, 2-n-propylaniline and 4-fluorophenethyl alcohol have been deposited in the RCSB Protein Data Bank as 1OV5, 1OV7, 1OVH, 1OVJ, 1OVK, 1OWY and 1OWZ, respectively.

Acknowledgements
This work was supported by NIH GM59597 (to B.K.S.) and by NIH GM21967 (to B.W.M.). We are grateful to Walt Baase for many enlightening discussions. We thank Alan Graves, Brian Feng, Ruth Brenk, and Veena Thomas for reading this manuscript. DOCK3.5.54 is available for academic research free of charge.

References
1. Stevens, R. C., Yokoyama, S. & Wilson, I. A. (2001). Global efforts in structural genomics. Science, 294, 89 ­ 92. 2. Abagyan, R. & Totrov, M. (2001). High-throughput docking for lead generation. Curr. Opin. Chem. Biol. 5, 375­ 382. 3. Boehm, H. J., Boehringer, M., Bur, D., Gmuender, H., Huber, W., Klaus, W. et al. (2000). Novel inhibitors of DNA gyrase: 3D structure based biased needle screening, hit validation by biophysical methods, and 3D guided optimization. A promising alternative to random screening. J. Med. Chem. 43, 2664­ 2674. 4. Enyedy, I. J., Ling, Y., Nacro, K., Tomita, Y., Wu, X., Cao, Y. et al. (2001). Discovery of small-molecule inhibitors of Bcl-2 through structure-based computer screening. J. Med. Chem. 44, 4313­ 4324. 5. Gruneberg, S., Wendt, B. & Klebe, G. (2001). Subnanomolar inhibitors from computer screening: a model study using human carbonic anhydrase II. Angew. Chem. Int. Ed. 40, 389­ 393. 6. Schapira, M., Raaka, B. M., Samuels, H. H. & Abagyan, R. (2001). In silico discovery of novel retinoic acid receptor agonist structures. BMC Struct. Biol. 1, 1. 7. Doman, T. N., McGovern, S. L., Witherbee, B. J., Kasten, T. P., Kurumbail, R., Stallings, W. C. et al. (2002). Molecular docking and high-throughput screening for novel inhibitors of protein tyrosine phosphatase-1B. J. Med. Chem. 45, 2213 ­2221. 8. Powers, R. A., Morandi, F. & Shoichet, B. K. (2002). Structure-based discovery of a novel, noncovalent inhibitor of AmpC beta-lactamase. Structure (Camb), 10, 1013­ 1023. 9. Soelaiman, S., Wei, B. Q., Bergson, P., Lee, Y. S., Shen, Y., Mrksich, M. et al. (2003). Structure-based inhibitor discovery against adenylyl cyclase toxins from pathogenic bacteria that cause anthrax and whooping cough. J. Biol. Chem. 3, 3. 10. Brenk, R., Naerum, L., Gradler, U., Gerber, H. D., Garcia, G. A., Reuter, K. et al. (2003). Virtual screening for submicromolar leads of tRNA-guanine transglycosylase based on a new unexpected binding mode detected by crystal structure analysis. J. Med. Chem. 46, 1133­1143.

Testing a Flexible-receptor Docking Algorithm

1181

11. Lesk, A. M. & Chothia, C. (1988). Elbow motion in the immunoglobulins involves a molecular ball-andsocket joint. Nature, 335, 188­ 190. 12. Baldwin, E. P., Hajiseyedjavadi, O., Baase, W. A. & Matthews, B. W. (1993). The role of backbone flexibility in the accommodation of variants that repack the core of T4 lysozyme. Science, 262, 1715 ­1718. 13. Strynadka, N. C., Jensen, S. E., Alzari, P. M. & James, M. N. (1996). A potent new mode of beta-lactamase ° inhibition revealed by the 1.7 A X-ray crystallographic structure of the TEM-1-BLIP complex. Nature Struct. Biol. 3, 290­ 297. 14. Najmanovich, R., Kuttner, J., Sobolev, V. & Edelman, M. (2000). Side-chain flexibility in proteins upon ligand binding. Proteins: Struct. Funct. Genet. 39, 261­268. 15. Murray, C. W., Baxter, C. A. & Frenkel, A. D. (1999). The sensitivity of the results of molecular docking to induced fit effects: application to thrombin, thermolysin and neuraminidase. J. Comput. Aid. Mol. Des. 13, 547­ 562. 16. Carlson, H. A. (2002). Protein flexibility and drug design: how to hit a moving target. Curr. Opin. Chem. Biol. 6, 447­ 452. 17. Teague, S. J. (2003). Implications of protein flexibility for drug discovery. Nature Rev. Drug Discov. 2, 527­541. 18. Totrov, M. & Abagyan, R. (1997). Flexible proteinligand docking by global energy optimization in internal coordinates. Proteins: Struct. Funct. Genet., 215­220. 19. Schnecke, V., Swanson, C. A., Getzoff, E. D., Tainer, J. A. & Kuhn, L. A. (1998). Screening a peptidyl database for potential ligands to proteins with side-chain flexibility. Proteins: Struct. Funct. Genet. 33, 74 ­ 87. 20. Schnecke, V. & Kuhn, L. A. (2000). Virtual screening with solvation and ligand-induced complementarity. Perspect. Drug Discov. Des. 20, 171­ 190. 21. Ponder, J. W. & Richards, F. M. (1987). Tertiary templates for proteins. Use of packing criteria in the enumeration of allowed sequences for different structural classes. J. Mol. Biol. 193, 775­ 791. 22. Leach, A. R. (1994). Ligand docking to proteins with discrete side-chain flexibility. J. Mol. Biol. 235, 345­356. 23. Kallblad, P. & Dean, P. M. (2003). Efficient conformational sampling of local side-chain flexibility. J. Mol. Biol. 326, 1651 ­1665. 24. Frimurer, T. M., Peters, G. H., Iversen, L. F., Andersen, H. S., Moller, N. P. & Olsen, O. H. (2003). Ligand-induced conformational changes: improved predictions of ligand binding conformations and affinities. Biophys. J. 84, 2273­ 2281. 25. Carlson, H. A., Masukawa, K. M., Rubins, K., Bushman, F. D., Jorgensen, W. L., Lins, R. D. et al. (2000). Developing a dynamic pharmacophore model for HIV-1 integrase. J. Med. Chem. 43, 2100­2114. 26. Broughton, H. B. (2000). A method for including protein flexibility in protein-ligand docking: improving tools for database mining and virtual screening. J. Mol. Graph. Model, 18, 247­ 257. 302­ 304. 27. Knegtel, R. M., Kuntz, I. D. & Oshiro, C. M. (1997). Molecular docking to ensembles of protein structures. J. Mol. Biol. 266, 424­ 440. 28. Osterberg, F., Morris, G. M., Sanner, M. F., Olson, A. J. & Goodsell, D. S. (2002). Automated docking to multiple target structures: incorporation of protein

29.

30.

31.

32.

33.

34. 35.

36.

37.

38.

39.

40. 41.

42.

43.

44.

mobility and structural water heterogeneity in AutoDock. Proteins: Struct. Funct. Genet. 46, 34 ­ 40. Claussen, H., Buning, C., Rarey, M. & Lengauer, T. (2001). FlexE: efficient molecular docking considering protein structure variations. J. Mol. Biol. 308, 377 ­395. Eriksson, A. E., Baase, W. A., Wozniak, J. A. & Matthews, B. W. (1992). A cavity-containing mutant of T4 lysozyme is stabilized by buried benzene. Nature, 355, 371­ 373. Morton, A., Baase, W. A. & Matthews, B. W. (1995). Energetic origins of specificity of ligand binding in an interior nonpolar cavity of T4 lysozyme. Biochemistry, 34, 8564­8575. Su, A. I., Lorber, D. M., Weston, G. S., Baase, W. A., Matthews, B. W. & Shoichet, B. K. (2001). Docking molecules by families to increase the diversity of hits in database screens: computational strategy and experimental evaluation. Proteins: Struct. Funct. Genet. 42, 279­ 293. Wei, B. Q., Baase, W. A., Weaver, L. H., Matthews, B. W. & Shoichet, B. K. (2002). A model binding site for testing scoring functions in molecular docking. J. Mol. Biol. 322, 339­ 355. Montfort, W. R. & Weichsel, A. (1997). Thymidylate synthase: structure, inhibition, and strained conformations during catalysis. Pharmacol. Ther. 76, 29 ­ 43. Montfort, W. R., Perry, K. M., Fauman, E. B., FinerMoore, J. S., Maley, G. F., Hardy, L. et al. (1990). Structure, multiple site binding, and segmental accommodation in thymidylate synthase on binding dUMP and an anti-folate. Biochemistry, 29, 6964 ­6977. Weichsel, A. & Montfort, W. R. (1995). Ligandinduced distortion of an active site in thymidylate synthase upon binding anticancer drug 1843U89. Nature Struct. Biol. 2, 1095­ 1101. Fritz, T. A., Tondi, D., Finer-Moore, J. S., Costi, M. P. & Stroud, R. M. (2001). Predicting and harnessing protein flexibility in the design of species-specific inhibitors of thymidylate synthase. Chem. Biol. 8, 981 ­995. Eriksson, A. E., Baase, W. A., Zhang, X. J., Heinz, D. W., Blaber, M., Baldwin, E. P. & Matthews, B. W. (1992). Response of a protein structure to cavity-creating mutations and its relation to the hydrophobic effect. Science, 255, 178­ 183. Jones, T. R., Varney, M. D., Webber, S. E., Lewis, K. K., Marzoni, G. P., Palmer, C. L. et al. (1996). Structurebased design of lipophilic quinazoline inhibitors of thymidylate synthase. J. Med. Chem. 39, 904­ 917. Creighton, T. E. (1993). Proteins: Structures and Molecular Properties, Freeman, New York. Stout, T. J. & Stroud, R. M. (1996). The complex of the anti-cancer therapeutic, BW1843U89, with ° thymidylate synthase at 2.0 A resolution: implications for a new mode of inhibition. Structure, 4, 67­ 77. Rutenber, E. E. & Stroud, R. M. (1996). Binding of the anticancer drug ZD1694 to E. coli thymidylate synthase: assessing specificity and affinity. Structure, 4, 1317­1324. Morton, A. & Matthews, B. W. (1995). Specificity of ligand binding in a buried nonpolar cavity of T4 lysozyme: linkage of dynamics and structural plasticity. Biochemistry, 34, 8576­ 8588. Mulder, F. A., Hon, B., Muhandiram, D. R., Dahlquist, F. W. & Kay, L. E. (2000). Flexibility and ligand exchange in a buried cavity mutant of T4

1182

Testing a Flexible-receptor Docking Algorithm

45. 46.

47. 48.

49.

50.

51.

52.

53. 54.

lysozyme studied by multinuclear NMR. Biochemistry, 39, 12614­12622. Lorber, D. M. & Shoichet, B. K. (1998). Flexible ligand docking using conformational ensembles. Protein Sci. 7, 938­ 950. Lorber, D. M., Udo, M. K. & Shoichet, B. K. (2002). Protein ­ protein docking with multiple residue conformations and residue substitutions. Protein Sci. 11, 1393­ 1408. Meng, E. C., Shoichet, B. K. & Kuntz, I. D. (1992). Automated docking with grid-based energy evaluation. J. Comput. Chem. 13, 505­ 524. Nicholls, A. & Honig, B. (1991). A rapid finite difference algorithm. Utilizing successive overrelaxation to solve the Poisson ­ Boltzmann equation. J. Comput. Chem. 12, 435­ 445. Chambers, C. C., Hawkins, G. D., Cramer, C. J. & Truhlar, D. G. (1996). Model for aqueous solvation based on class IV atomic charges and first solvation shell effects. J. Phys. Chem. 100, 16385­ 16398. Li, J. B., Zhu, T. H., Cramer, C. J. & Truhlar, D. G. (1998). New class IV charge model for extracting accurate partial charges from wave functions. J. Phys. Chem. ser. A, 102, 1820­ 1831. Kuntz, I. D., Blaney, J. M., Oatley, S. J., Langridge, R. & Ferrin, T. E. (1982). A geometric approach to macromolecule-ligand interactions. J. Mol. Biol. 161, 269­ 288. Meng, E. C., Gschwend, D. A., Blaney, J. M. & Kuntz, I. D. (1993). Orientational sampling and rigid-body minimization in molecular docking. Proteins: Struct. Funct. Genet. 17, 266­ 278. Cambillau, C. & Roussel, A. (1997). Turbo Frodo (Open, G. L., ed.), Universite Aix-Marseille II, Marseille, France. Shoichet, B. K. & Kuntz, I. D. (1993). Matching

55.

56. 57. 58.

59.

chemistry and shape in molecular docking. Protein Eng. 6, 723­ 732. Liang, J., Edelsbrunner, H. & Woodward, C. (1998). Anatomy of protein pockets and cavities: measurement of binding site geometry and implications for ligand design. Protein Sci. 7, 1884­1897. Kirchhoff, W. (1993). EXAM: A Two-state Thermodynamic Analysis Program, Gaithersburg, Maryland. Hamlin, R. (1985). Multiwire area X-ray diffractometers. Methods Enzymol. 114, 416­ 452. Tronrud, D. E., Teneyck, L. F. & Matthews, B. W. (1987). An efficient general-purpose least-squares refinement program for macromolecular structures. Acta Crystallog. sect. A, 43, 489­ 501. Ferrin, T. E., Huang, C. C., Jarvis, L. E. & Langridge, R. (1988). The MIDAS display system. J. Mol. Graph. 6, 13 ­ 27.

Edited by B. Honig (Received 4 August 2003; received in revised form 8 December 2003; accepted 5 February 2004)

Supplementary Material comprising one Figure and three Tables is available on Science Direct

